"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[951],{8453(e,n,d){d.d(n,{R:()=>s,x:()=>c});var r=d(6540);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}},9379(e,n,d){d.r(n),d.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>a,frontMatter:()=>s,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"api-reference/motifs/index","title":"Motifs API","description":"The Component Constructors","source":"@site/docs/api-reference/motifs/index.md","sourceDirName":"api-reference/motifs","slug":"/api-reference/motifs/","permalink":"/loom/canary/api-reference/motifs/","draft":false,"unlisted":false,"editUrl":"https://github.com/leonieziechmann/loom/tree/main/docs/docs/api-reference/motifs/index.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Engine API","permalink":"/loom/canary/api-reference/core"},"next":{"title":"The Frame Object","permalink":"/loom/canary/api-reference/motifs/frame"}}');var t=d(4848),i=d(8453);const s={sidebar_position:2},c="Motifs API",l={},o=[{value:"<code>motif.managed</code>",id:"motifmanaged",level:2},{value:"Parameters",id:"parameters",level:3},{value:"<code>motif.content</code>",id:"motifcontent",level:2},{value:"Parameters",id:"parameters-1",level:3},{value:"<code>motif.data</code>",id:"motifdata",level:2},{value:"Parameters",id:"parameters-2",level:3},{value:"<code>motif.compute</code>",id:"motifcompute",level:2},{value:"Parameters",id:"parameters-3",level:3},{value:"<code>motif.plain</code>",id:"motifplain",level:2},{value:"Parameters",id:"parameters-4",level:3}];function h(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"motifs-api",children:"Motifs API"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"The Component Constructors"})}),"\n",(0,t.jsx)(n.p,{children:'Motifs are the reactive building blocks of a Loom document. Instead of using standard Typst functions, you wrap your logic in these constructors to enable the "Measure -> Draw" cycle.'}),"\n",(0,t.jsxs)(n.p,{children:["These constructors are available on the ",(0,t.jsx)(n.code,{children:"motif"})," object returned by ",(0,t.jsx)(n.code,{children:"construct-loom"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typ",children:"#let (motif, ..) = loom.construct-loom(<app>)\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"motifmanaged",children:(0,t.jsx)(n.code,{children:"motif.managed"})}),"\n",(0,t.jsxs)(n.p,{children:['The "Smart" component constructor. Unlike a raw ',(0,t.jsx)(n.code,{children:"motif"}),", this wrapper automatically handles ",(0,t.jsx)(n.strong,{children:"Identity"})," and ",(0,t.jsx)(n.strong,{children:"Path Management"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["It pushes its ",(0,t.jsx)(n.code,{children:"name"})," to the system path (",(0,t.jsx)(n.code,{children:"sys.path"}),") in the context."]}),"\n",(0,t.jsxs)(n.li,{children:["It automatically wraps your return signal in a ",(0,t.jsx)(n.code,{children:"Frame"})," object containing ",(0,t.jsx)(n.code,{children:"{ kind, key, path, signal }"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Use this for any component that needs to be queryable (e.g., Figures, Sections, Tasks)."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typ",children:"motif.managed(\n  name,\n  scope: (ctx) => ctx,\n  measure: (ctx, children-data) => (signal, view),\n  draw: (ctx, signal, view, body) => content,\n  body\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"name"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"str"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"required"})}),(0,t.jsx)(n.td,{children:'The name/kind of this component (e.g., "task"). Used for path generation and querying.'})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"scope"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(ctx) => dict"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"id"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Provider."})," A function that returns a modified context for its ",(0,t.jsx)(n.em,{children:"children"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"measure"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(..) => (none, none)"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Logic Phase."})," ",(0,t.jsx)(n.code,{children:"(ctx, children) => (signal, view)"}),". Calculates the raw data (",(0,t.jsx)(n.code,{children:"signal"}),") and view model (",(0,t.jsx)(n.code,{children:"view"}),"). The signal is automatically wrapped in a ",(0,t.jsx)(n.code,{children:"Frame"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"draw"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(..) => body"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Render Phase."})," ",(0,t.jsx)(n.code,{children:"(ctx, signal, view, body) => content"}),". Returns the final visual content."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"body"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"content"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"required"})}),(0,t.jsx)(n.td,{children:"The child content to process."})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"motifcontent",children:(0,t.jsx)(n.code,{children:"motif.content"})}),"\n",(0,t.jsxs)(n.p,{children:["A simplified wrapper for ",(0,t.jsx)(n.strong,{children:"Visual-Only"})," components.\nIt is transparent to signals: it propagates its children's signals upward without modification, but it does not emit its own identity or manage paths."]}),"\n",(0,t.jsx)(n.p,{children:"Use this for styling wrappers (e.g., Cards, Callouts) that don't need to be queried."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typ",children:"motif.content(\n  scope: (ctx) => ctx,\n  draw: (ctx, body) => content,\n  ..body\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"parameters-1",children:"Parameters"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"scope"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(ctx) => dict"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"id"})}),(0,t.jsx)(n.td,{children:"Optional context modification for children."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"draw"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(ctx, body) => body"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Render Phase."})," ",(0,t.jsx)(n.code,{children:"(ctx, body) => content"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"body"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"content"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"optional"})}),(0,t.jsx)(n.td,{children:"The content to wrap. Can be passed as a positional argument."})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"motifdata",children:(0,t.jsx)(n.code,{children:"motif.data"})}),"\n",(0,t.jsxs)(n.p,{children:["A specialized primitive for ",(0,t.jsx)(n.strong,{children:"Data Leaves"}),".\nThese components have ",(0,t.jsx)(n.strong,{children:"no body"})," (they render nothing) and exist solely to inject data into the system."]}),"\n",(0,t.jsx)(n.p,{children:"Use this for metadata, configuration, or ingredients."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typ",children:"motif.data(\n  name,\n  scope: (ctx) => ctx,\n  measure: (ctx) => signal,\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"parameters-2",children:"Parameters"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"name"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"str"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"required"})}),(0,t.jsx)(n.td,{children:"The name/kind of the data node."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"scope"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(ctx) => dict"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"id"})}),(0,t.jsx)(n.td,{children:"Optional context modification for children."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"measure"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(ctx) => none"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Logic Phase."})," ",(0,t.jsx)(n.code,{children:"(ctx) => signal"}),". Returns the raw data payload. Note: It does not receive children."]})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"motifcompute",children:(0,t.jsx)(n.code,{children:"motif.compute"})}),"\n",(0,t.jsxs)(n.p,{children:["A flexible helper for intermediate calculations. It simplifies the ",(0,t.jsx)(n.code,{children:"measure"})," signature to return ",(0,t.jsx)(n.em,{children:"only"})," the public signal, automatically setting the view model to ",(0,t.jsx)(n.code,{children:"none"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["It can behave like a ",(0,t.jsx)(n.code,{children:"managed"})," motif (if ",(0,t.jsx)(n.code,{children:"name"})," is provided) or a raw ",(0,t.jsx)(n.code,{children:"motif"})," (if ",(0,t.jsx)(n.code,{children:"name"})," is ",(0,t.jsx)(n.code,{children:"none"}),")."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typ",children:"motif.compute(\n  name: none,\n  scope: (ctx) => ctx,\n  measure: (ctx, children-data) => signal,\n  body\n)\n\n"})}),"\n",(0,t.jsx)(n.h3,{id:"parameters-3",children:"Parameters"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"name"})})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"str"})," or ",(0,t.jsx)(n.code,{children:"none"})]}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"none"})}),(0,t.jsxs)(n.td,{children:["Optional name. If provided, it behaves like ",(0,t.jsx)(n.code,{children:"motif.managed"})," (adding to path and wrapping in a Frame)."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"scope"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(ctx) => dict"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"id"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Provider."})," A function that returns a modified context for its ",(0,t.jsx)(n.em,{children:"children"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"measure"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(..) => none"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Logic Phase."})," ",(0,t.jsx)(n.code,{children:"(ctx, children) => signal"}),". Returns the raw data. Unlike ",(0,t.jsx)(n.code,{children:"managed"}),", it does not return a view model."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"body"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"content"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"required"})}),(0,t.jsx)(n.td,{children:"The child content to process."})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"motifplain",children:(0,t.jsx)(n.code,{children:"motif.plain"})}),"\n",(0,t.jsxs)(n.p,{children:["The raw primitive. This is the low-level wrapper that creates the engine metadata block. It performs ",(0,t.jsx)(n.strong,{children:"no"})," automatic path management, frame wrapping, or signal propagation."]}),"\n",(0,t.jsxs)(n.p,{children:["Use this only if you need to implement a completely custom protocol that doesn't fit the ",(0,t.jsx)(n.code,{children:"managed"})," or ",(0,t.jsx)(n.code,{children:"content"})," patterns."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typ",children:"motif.plain(\n  key: <motif>,\n  scope: (ctx) => ctx,\n  measure: (ctx, children-data) => (signal, view),\n  draw: (ctx, signal, view, body) => content,\n  body\n)\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsx)(n.p,{children:"Data Contract Unlike managed motifs, motif.plain does not automatically wrap your data. The signal returned by your measure function must strictly be:"}),(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"none"})}),"\n",(0,t.jsxs)(n.li,{children:["A single Frame object (created via ",(0,t.jsx)(n.code,{children:"loom.frame.new"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"An array of Frame objects"}),"\n"]}),(0,t.jsx)(n.p,{children:"Returning raw data (like a string or dictionary) directly as a signal will cause a Data Contract Violation panic."})]}),"\n",(0,t.jsx)(n.h3,{id:"parameters-4",children:"Parameters"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"key"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"label"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"<motif>"})}),(0,t.jsx)(n.td,{children:"The internal metadata label used by the Loom engine to identify this block."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"scope"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(ctx) => dict"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"id"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Provider."})," Explicitly defines the context passed to children."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"measure"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(..) => (none, none)"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Logic Phase."})," ",(0,t.jsx)(n.code,{children:"(ctx, children) => (signal, view)"}),". Returns the component's public signal and internal view model. ",(0,t.jsx)(n.strong,{children:"Must return valid Frames for the signal."})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"draw"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"function"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(..) => body"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Render Phase."})," ",(0,t.jsx)(n.code,{children:"(ctx, signal, view, body) => content"}),". Direct control over the final output."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"body"})})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"content"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"required"})}),(0,t.jsx)(n.td,{children:"The child content to process."})]})]})]})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);