"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[140],{1916(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"concepts/data-flow","title":"Data Flow","description":"The Vertical Highway","source":"@site/docs/concepts/data-flow.md","sourceDirName":"concepts","slug":"/concepts/data-flow","permalink":"/loom/concepts/data-flow","draft":false,"unlisted":false,"editUrl":"https://github.com/leonieziechmann/loom/tree/main/docs/concepts/data-flow.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"The Mental Model","permalink":"/loom/concepts/mental-model"},"next":{"title":"State Management & Mutators","permalink":"/loom/concepts/state-management"}}');var s=t(4848),l=t(8453);const r={sidebar_position:2},o="Data Flow",d={},a=[{value:"The V-Model",id:"the-v-model",level:2},{value:"Direction 1: Down (Context)",id:"direction-1-down-context",level:3},{value:"Direction 2: Up (Signals)",id:"direction-2-up-signals",level:3},{value:"The &quot;Missing&quot; Direction: Lateral Flow",id:"the-missing-direction-lateral-flow",level:2},{value:"The Solution: The &quot;Up-and-Down&quot; Maneuver",id:"the-solution-the-up-and-down-maneuver",level:3},{value:"Data Visibility Cheatsheet",id:"data-visibility-cheatsheet",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"data-flow",children:"Data Flow"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"The Vertical Highway"})}),"\n",(0,s.jsxs)(n.p,{children:['In standard Typst, data is static. In Loom, data is constantly moving.\nTo build effective templates, you need to understand the "Vertical Highway": ',(0,s.jsx)(n.strong,{children:"Context flows down, Signals flow up."})]}),"\n",(0,s.jsx)(n.h2,{id:"the-v-model",children:"The V-Model"}),"\n",(0,s.jsxs)(n.p,{children:["The easiest way to visualize a Loom component is not as a box, but as a ",(0,s.jsx)(n.strong,{children:'"V" shape'}),".\nData travels down the left side, hits the bottom (where children live), and travels up the right side."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"      (Parent)\n         |\n    1. Scope (Down)  [ Context -> ]\n         |\n         v\n    +---------+\n    |  Child  |  <-- 2. Children Executed\n    +---------+\n         |\n    3. Measure (Up)  [ <- Signals ]\n         |\n         v\n    4. Draw (Out)    [ Content ]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"direction-1-down-context",children:"Direction 1: Down (Context)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vehicle:"})," The Scope Function."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Payload:"})," Configuration, Theme, Counters, Flags."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Behavior:"})," ",(0,s.jsx)(n.strong,{children:"Inheritance."})]}),"\n",(0,s.jsxs)(n.li,{children:["Data injected here is visible to the component itself ",(0,s.jsx)(n.strong,{children:"and"})," all its descendants."]}),"\n",(0,s.jsxs)(n.li,{children:["Think of it like CSS: If you set ",(0,s.jsx)(n.code,{children:"color: red"})," at the top, it cascades down until someone overrides it."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"direction-2-up-signals",children:"Direction 2: Up (Signals)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vehicle:"})," The Measure Function."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Payload:"})," Prices, Page Numbers, TOC Entries, Metadata."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Behavior:"})," ",(0,s.jsx)(n.strong,{children:"Bubbling."})]}),"\n",(0,s.jsxs)(n.li,{children:["Data emitted here is sent to the ",(0,s.jsx)(n.strong,{children:"Parent's"})," measure function."]}),"\n",(0,s.jsxs)(n.li,{children:["It is ",(0,s.jsx)(n.strong,{children:"not"})," visible to siblings."]}),"\n",(0,s.jsxs)(n.li,{children:["It is ",(0,s.jsx)(n.strong,{children:"not"})," visible to children."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"the-missing-direction-lateral-flow",children:'The "Missing" Direction: Lateral Flow'}),"\n",(0,s.jsxs)(n.p,{children:["A common question is: ",(0,s.jsx)(n.em,{children:'"How do I make Component A talk to Component B next to it?"'})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typ",children:'#item("A") // I want to know B\'s width!\n#item("B")\n'})}),"\n",(0,s.jsxs)(n.p,{children:["In Loom, ",(0,s.jsx)(n.strong,{children:"siblings cannot talk directly to each other"})," within the same pass."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'"A" finishes executing before "B" even starts.'}),"\n",(0,s.jsx)(n.li,{children:'"B" cannot send data back in time to "A".'}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"the-solution-the-up-and-down-maneuver",children:'The Solution: The "Up-and-Down" Maneuver'}),"\n",(0,s.jsx)(n.p,{children:"To share data between siblings, you must route it through a common ancestor."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pass 1 (Up):"})," Siblings emit signals (e.g., their widths) up to the Parent."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pass 2 (Down):"}),' The Parent collects these signals, calculates the "max width," and injects it back down via Scope.']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pass 2 (Stable):"})," Now both siblings can read ",(0,s.jsx)(n.code,{children:"ctx.max-width"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This is why Loom runs multiple passes. It needs time to route the traffic."}),"\n",(0,s.jsx)(n.h2,{id:"data-visibility-cheatsheet",children:"Data Visibility Cheatsheet"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"If data is defined in..."}),(0,s.jsx)(n.th,{children:"It is visible to..."})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Parent Scope"})}),(0,s.jsxs)(n.td,{children:["Parent (Measure/Draw), ",(0,s.jsx)(n.strong,{children:"Children"}),", Grandchildren"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Child Scope"})}),(0,s.jsx)(n.td,{children:"Child (Measure/Draw), Grandchildren"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Child Measure (Public)"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"Parent"})," (Measure)"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Child Measure (Private)"})}),(0,s.jsx)(n.td,{children:"Child (Draw)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Sibling A"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"Nobody"})," (horizontally)"]})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>o});var i=t(6540);const s={},l=i.createContext(s);function r(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);