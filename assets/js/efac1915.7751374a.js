"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1922],{4264(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"advanced/limitations","title":"Limitations & Constraints","description":"Boundaries of the Engine","source":"@site/docs/advanced/limitations.md","sourceDirName":"advanced","slug":"/advanced/limitations","permalink":"/loom/advanced/limitations","draft":false,"unlisted":false,"editUrl":"https://github.com/leonieziechmann/loom/tree/main/docs/docs/advanced/limitations.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Performance & Optimization","permalink":"/loom/advanced/performance"},"next":{"title":"Debugging & Troubleshooting","permalink":"/loom/advanced/debugging"}}');var s=t(4848),o=t(8453);const r={sidebar_position:2},a="Limitations & Constraints",l={},c=[{value:"1. Vertical-Only Communication (Sibling Latency)",id:"1-vertical-only-communication-sibling-latency",level:2},{value:"2. Show Rule Invisibility",id:"2-show-rule-invisibility",level:2},{value:"3. Opaque Named Fields",id:"3-opaque-named-fields",level:2},{value:"4. Nesting Depth (Stack Limits)",id:"4-nesting-depth-stack-limits",level:2},{value:"5. Performance Overhead",id:"5-performance-overhead",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"limitations--constraints",children:"Limitations & Constraints"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Boundaries of the Engine"})}),"\n",(0,s.jsxs)(n.p,{children:["Loom is a meta-engine running ",(0,s.jsx)(n.em,{children:"inside"})," Typst. While it pushes the language to its limits, it is still bound by the runtime's rules. Understanding these constraints will save you hours of debugging."]}),"\n",(0,s.jsx)(n.h2,{id:"1-vertical-only-communication-sibling-latency",children:"1. Vertical-Only Communication (Sibling Latency)"}),"\n",(0,s.jsx)(n.p,{children:'This is the most common "Gotcha" for new users.'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Constraint:"}),"\nData in Loom flows strictly ",(0,s.jsx)(n.strong,{children:"Vertically"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Down (Scope)"}),"\n",(0,s.jsx)(n.li,{children:"Up (Signals)"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Sibling components (neighbors) cannot talk to each other directly in the same pass."}),"\nIf Component A calculates a value, Component B (sitting next to it) cannot see it immediately. A signal must travel all the way up to the ",(0,s.jsx)(n.strong,{children:"Document Root"})," to be collected by the engine and reinjected into the Context for the ",(0,s.jsx)(n.em,{children:"next"})," pass."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Workaround:"}),"\nYou must rely on ",(0,s.jsx)(n.strong,{children:"Time Travel"})," (Multiple Passes)."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pass 1:"})," Sibling A emits a signal. It bubbles up through the parent to the ",(0,s.jsx)(n.strong,{children:"Root"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pass 2:"})," The ",(0,s.jsx)(n.code,{children:"weave"})," function injects this signal into the Global Context."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Result:"})," Sibling B reads the data from ",(0,s.jsx)(n.code,{children:"ctx"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:'Note: This "Root Round-Trip" is why complex dependencies require more passes.'})}),"\n",(0,s.jsx)(n.h2,{id:"2-show-rule-invisibility",children:"2. Show Rule Invisibility"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Constraint:"}),"\nLoom operates on the document structure (AST) ",(0,s.jsx)(n.em,{children:"before"})," standard Typst ",(0,s.jsx)(n.code,{children:"#show"})," rules are fully resolved.\nIf you use a ",(0,s.jsx)(n.code,{children:"#show"})," rule to transform raw text into a Loom component, the engine ",(0,s.jsx)(n.strong,{children:"will not see it"})," during the measure phase, meaning it won't emit signals or run logic."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Workaround:"}),"\nLoom components must be explicitly present in your source code. Use function calls instead of show rules for semantic elements."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typ",children:'// \u2705 Do this\n#task("Finish Documentation")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"3-opaque-named-fields",children:"3. Opaque Named Fields"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Constraint:"}),"\nCurrently, Loom's engine does not inspect the ",(0,s.jsx)(n.strong,{children:"named arguments"})," of standard Typst functions (like ",(0,s.jsx)(n.code,{children:"caption"}),", ",(0,s.jsx)(n.code,{children:"header"}),", or ",(0,s.jsx)(n.code,{children:"footer"}),").\nIf you place a component inside a ",(0,s.jsx)(n.code,{children:"figure(caption: [...])"}),", it will be treated as opaque content. It will render, but it cannot interact with the reactive loop."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Note: This is technically possible to implement, but it is not yet supported in the current version."})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Workaround:"}),'\nCreate a "Smart Wrapper" that handles the logic ',(0,s.jsx)(n.em,{children:"outside"})," the opaque field."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typ",children:"// \u2705 Workaround: A custom figure component\n#let smart-figure(body, caption-text) = motif(\n  measure: (ctx, _) => {\n    // Perform logic here (e.g., auto-numbering)\n    ( (figure-count: 1), none )\n  },\n  draw: (ctx, _, _, body) => {\n    // Construct the standard Typst figure in the draw phase\n    figure(body, caption: caption-text)\n  }\n)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"4-nesting-depth-stack-limits",children:"4. Nesting Depth (Stack Limits)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Constraint:"}),"\nLoom uses recursion to traverse the tree. Typst has a fixed stack size.\nNesting Loom components deeper than approximately ",(0,s.jsx)(n.strong,{children:"50-60 levels"}),' will trigger a runtime panic ("stack overflow").']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Workaround:"}),"\n",(0,s.jsx)(n.strong,{children:"Flatten your structure."})," Don't wrap every single word in a component. Use ",(0,s.jsx)(n.code,{children:"query.collect"})," to gather data from a flat list rather than relying on deep nested bubbling."]}),"\n",(0,s.jsx)(n.h2,{id:"5-performance-overhead",children:"5. Performance Overhead"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Constraint:"}),"\nEvery Context mutation creates a copy of the state dictionary.\nDocuments with ",(0,s.jsx)(n.strong,{children:"thousands"})," of reactive nodes will be slow (~seconds to compile)."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["Note: Using ",(0,s.jsx)(n.code,{children:"data-motif"})," does not significantly improve performance compared to ",(0,s.jsx)(n.code,{children:"content-motif"}),", as the engine traversal cost is the main factor."]})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Workaround:"}),"\n",(0,s.jsx)(n.strong,{children:"Scope the Engine."}),"\nInstead of wrapping your entire 100-page thesis in ",(0,s.jsx)(n.code,{children:"weave"}),', only wrap the specific sections that need reactivity (e.g., the "Executive Summary" or "Dashboard").']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Trade-off:"}),"\nLoom instances are ",(0,s.jsx)(n.strong,{children:"Isolated Islands"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A ",(0,s.jsx)(n.code,{children:"weave"})," block on Page 1 cannot share state with a ",(0,s.jsx)(n.code,{children:"weave"})," block on Page 50."]}),"\n",(0,s.jsxs)(n.li,{children:["Standard Typst ",(0,s.jsx)(n.code,{children:"state"})," does not work reliably across passes."]}),"\n",(0,s.jsx)(n.li,{children:"You must choose: Either wrap the whole document (slower, shared state) or split it up (faster, isolated state)."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>a});var i=t(6540);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);